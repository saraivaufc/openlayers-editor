<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: service/storage.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: service/storage.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Service from './service';

/**
 * OLE storage service.
 * Base class for storage services,
 * such as LocalStorage, PermalinkStorage, CookieStorage.
 * @alias ole.service.Storage
 */
export default class Storage extends Service {
  /**
   * Saves control properties.
   * @param {object} [options] Service options
   * @param {array.&lt;ol.control.Control>} [controls] List of controls.
   *  If undefined, all controls of the editor are used.
   */
  constructor(optOptions) {
    const options = optOptions || {};
    super(options);

    /**
     * List of service controls
     * @type {array.&lt;ol.control.Control>}
     * @private
     */
    this.controls = options.controls;

    /**
     * List of properties keys to ignore.
     * @type {array.&lt;string>}
     */
    this.ignoreKeys = ['title', 'image', 'className'];
  }

  /**
   * @inheritdoc
   */
  activate() {
    super.activate();
    this.controls = this.controls || this.editor.getControls().getArray();
    this.restoreProperties();
    this.restoreActiveControls();

    this.controls.forEach((control) => {
      control.addEventListener('propertychange', (evt) => {
        this.storeProperties(
          evt.detail.control.getProperties().title,
          evt.detail.properties,
        );
      });

      control.addEventListener('change:active', () => {
        this.storeActiveControls();
      });
    });
  }

  /**
   * @inheritdoc
   */
  deactivate() {
    super.deactivate();

    this.controls.forEach((control) => {
      control.removeEventListener('propertychange');
    });
  }

  /**
   * Store control properties.
   * @param {string} controlName Name of the control.
   * @param {object} properties Control properties.
   */
  storeProperties(controlName, properties) {
    const storageProps = {};
    const propKeys = Object.keys(properties);

    for (let i = 0; i &lt; propKeys.length; i += 1) {
      const key = propKeys[i];
      if (this.ignoreKeys.indexOf(key) === -1 &amp;&amp;
          !(properties[key] instanceof Object)) {
        storageProps[key] = properties[key];
      }
    }

    return storageProps;
  }

  /**
   * Restore the control properties.
   */
  restoreProperties() {
    // to be implemented by child class
  }

  /**
   * Store the active state of controls.
   */
  storeActiveControls() {
    const activeControls = this.editor.getActiveControls();
    return activeControls.getArray().map(c => c.getProperties().title);
  }

  /**
   * Restore the active state of the controls.
   */
  restoreActiveControls() {
    // to be implemented by child class
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Editor.html">Editor</a></li><li><a href="ole.BufferControl.html">BufferControl</a></li><li><a href="ole.CadControl.html">CadControl</a></li><li><a href="ole.Control.html">Control</a></li><li><a href="ole.DeleteControl.html">DeleteControl</a></li><li><a href="ole.Difference.html">Difference</a></li><li><a href="ole.DrawControl.html">DrawControl</a></li><li><a href="ole.Intersection.html">Intersection</a></li><li><a href="ole.ModifyControl.html">ModifyControl</a></li><li><a href="ole.MoveControl.html">MoveControl</a></li><li><a href="ole.RotateControl.html">RotateControl</a></li><li><a href="ole.Service.html">Service</a></li><li><a href="ole.service.LocalStorage.html">LocalStorage</a></li><li><a href="ole.service.Storage.html">Storage</a></li><li><a href="ole.service.Storage_Storage.html">Storage</a></li><li><a href="ole.Toolbar.html">Toolbar</a></li><li><a href="ole.TopologyControl.html">TopologyControl</a></li><li><a href="ole.Union.html">Union</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Apr 08 2019 08:10:08 GMT+0000 (UTC)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
